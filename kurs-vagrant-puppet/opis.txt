Vagrant + Puppet

1. Instalacja oprogramowania

VirtualBox
Vagrant

VirtualBox, Vagrant oraz Puppet to narzêdzia do uruchamiania systemów wirtualnyuch.

Konfiguracja maszyny wirtualnej jest zapisana w pliku vagrant file.

2. Pierwsza seria æwiczeñ: uruchamianie gotowych boxów.

Boxy precise oraz lucid to skonfigurowane bazowe dystrybucje linuxa ubuntu.
Najnowsza wersja linuxa jest zawarta w serii precise.
Wersja 64 nie dzia³a na wszystkich komputerach.
Bêdziemy wiêc pracowali na precise32.

Æwiczenie: 01-02-precise-32 pokazuje jak uruchomiæ system wirtualny opraty o
box precise 32.

Uruchomienie æwiczenia:

vagrant up

wy³±czenie systemu

vagrant destroy


Po uruchomieniu æwiczenia na komputer pobrany zostanie box precise32.

Jak siê dostaæ do systemu wirtualnego?
Przy u¿yciu ssh:

ssh -p2222 -i C:/Users/gajdaw/.vagrant.d/insecure_private_key vagrant@127.0.0.1
ssh -p2222 -i C:/Users/gajdaw/.vagrant.d/insecure_private_key -o StrictHostKeyChecking=no vagrant@127.0.0.1


Terminologia: Host, Guest
Host  - laptop (Windows)
Guest - system virtualny (ubuntu)

3. Synchronizacja folderów pomiêdzy systemami

Domy¶lnie synchronizowany jest folder, w którym wydajemy komendê vagrant up.
Folder ten jest widoczny w systemie wirtualnym jako /vagrant

Na komputerze Windows:  folder komenty vagrant up
W systemie wirtualnym Ubuntu: folder /vagrant


4. Rêczna instalacja zasobów w systemie wirtualnym

Wydajemy komendy:

    Lynx
        sudo apt-get install lynx-cur

    Git
        sudo apt-get install git


Wada rêcznej instalacji: po restarcie systemu zainstalowane sk³adniki nie s± obecne.

5. Zmiana synchronizowanego folderu

Opcja konfiguracyjna

  config.vm.synced_folder "./..", "/vagrant"

ustala synchronizacjê folderów.

Pierwszy parametr to folder na komputerze host (Windows)
Drugi parametr to folder w systemie guest (system wirtualny Linux)


6. Konfiguracja zasobów

Jednym z rozwi±zañ jest wykorzystanie do konfiguracji zasobów jêzyka puppet.

Zasoby opisujemy w pliku o rozszerzeniu .pp i ³adujemy komend±:

puppet apply file-1.pp

Rodzaje zasobów:

Plik
        file {'testfile':
              path    => '/vagrant/abc.txt',
              ensure  => present,
              mode    => 0640,
              content => "I'm a test file with abc.",
        }


Konto u¿ytkownika
        user { 'abc':
            ensure => 'present',
            home => '/home/abc',
        }

Sygnalizacja zdarzeñ:
    notify {'arbitrary title':
          message => "Some text...",
    }

Pe³na lista zasobów: http://docs.puppetlabs.com/references/latest/type.html


cron  - zadanie crona
exec  - wykonanie komendy
group - grupa w systemie
package - pakiet oprogramowania
service - us³uga w systemie
stage - etap przetwarzania konfiguracji





Praca domowa:
Æwiczenia
    exercise-01-02-precise32
    exercise-02-01-manual-apt-get
    exercise-02-01-resource


